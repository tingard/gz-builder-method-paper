% !TEX root = ../aas_submission.tex
\documentclass[../main.tex]{subfiles}
\begin{document}
\label{sec:results}

In this Section we present \textit{Galaxy Builder} models for 198 galaxies, both from simple aggregation of user classifications (aggregate models), and with parameters fine tuned by a numerical fit (fitted models). We explore the consistency with which volunteers modelled galaxies, the accuracy of the aggregate models, and compare the aggregate and fitted models to comparable results in the literature.

\subsection{The Calibration Set}

The calibration subset was a set of nine synthetic galaxy images created from \textit{Galaxy Builder} models, which were then re-run through the \textit{Galaxy Builder} process. These galaxies were used to fine-tune clustering and fitting hyperparameters (See Section \ref{sec:aggregation_of_volunteer_models}), as the ground truth was known. Our ability to recover morphology accurately is essential validation for our ability to recover good photometric models of galaxies.

Overall, these results highlight the importance of good priors to obtain accurate fits of complex photometric models. In more detail, the models recovered for the nine synthetic galaxy images demonstrate that:

\begin{enumerate}
  \item Model parameters were generally recovered to a high degree of accuracy
  \item We successfully recover all spiral arms present, and do not receive any false positives
The spiral pitch angles obtained through aggregation vary by $< 9\degree$ from the true values, with fitting improving this error slightly.
  \item Volunteers systematically use elongated bulges to model bar components. This resulted in two false positives for bulge presence in the aggregate models. This feature (switching light between model components) is a common issue in all photometric fitting methods \citep{2018MNRAS.473.4731K}.
  \item The Jaccard metric is unstable to small changes in rotation for highly elliptical components (i.e. bars). This resulted in one false negative of bar presence in the aggregate model.
\end{enumerate}

\begin{figure*}
  \plotone{images__results/calibration_parameter_recovery.pdf}
  \caption{Plots examining the accuracy of fit parameters for the calibration subset of galaxies. Most parameters are recovered to a high degree of accuracy, however S\'ersic index and boxyness are difficult to determine only using gradient descent, and the error in the fit values reflects this problem.}
  \label{fig:calibration_parameter_recovery}
\end{figure*}

The fitting step for this subset of images highlighted the benefit of obtaining a rough starting point through clustering of user classifications; the method struggled to recover structural parameters for which we did not obtain such a starting point (S\'ersic index and bar boxyness). These parameters are difficult to identify using gradient descent \citep{2012MNRAS.421.2277L}, suggesting future work should attempt to obtain priors on these parameters from volunteers and make use of a more robust fitting algorithm.

\subsection{Examination of Volunteer consistency}
We aggregate two independent models for a set of 98 galaxies based on ``original'' or repeat (``validation'') classifications, obtained with the same retirement limit (see Section \ref{sec:data} for more on this selection).

One of the simplest choices the volunteers have is whether to include a model component or not. Figure \ref{fig:volunteer_component_consistency} illustrates the consistency with which volunteers made use of a component in their model for a galaxy. We see that volunteer classification is very consistent, with scatter as predicted by the Binomial uncertainty on the mean. Volunteers almost always make us of a disc and bulge (as seen in the \textit{calibration subset}), and bulge, bar and spiral arm usage is consistent within Binomial error. One common challenge is that some volunteers used a very ellipsoidal bulge and the ends of spiral arms to model light that other users modelled with a bar. This caused some scatter in aggregate models.

In the end, the aggregated validation model is identical to the original aggregated model in around 40\% of galaxies. The most common changes are a missing bar component or a missing single spiral arm. This may suggest that more than 30 classifications should be collected per galaxy, or may be an artefact of the lack of consensus among volunteers for galaxies with difficult-to-determine components.

\begin{figure*}
  \plotone{images__results/component_frequency.pdf}
  \caption{Comparison of frequency of use of component in volunteer models between the original and validation sets of classifications. Errors shown on the disc, bulge and bar arise from Binomial error estimation. We see that classifications are generally consistent within errors, validating our assumption of volunteer independence.}
  \label{fig:volunteer_component_consistency}
\end{figure*}

After selecting a component, the volunteer sets its shape and size. The variation in axial ratios and effective radii for the aggregate discs, bulges and bars are shown in Figure \ref{fig:aggregate_model_consistency}. The aggregate discs and bulges are consistent within errors, however bars show more scatter. Bars are one of the most challenging components to aggregate consistently. This is partly because even a strongly barred galaxy with 30 classifications overall might receive only 15 or so drawn bars, and lower numbers of classifications result in more scatter. In addition the aggregation method is more sensitive to rotation of highly elongated shapes. Both factors probably contribute to lower consistency in bar components.

\begin{figure*}
  \plotone{images__results/component_sizing.pdf}
  \caption{Comparison of component shape in aggregate models between the original and validation sets. Errors are obtained through the sample variance of clustered components, as detailed in Section \ref{sec:error_estimation}. We see close agreement between aggregate components from the two sets, suggesting that the clustering method is robust to the scatter in classifications.}
  \label{fig:aggregate_model_consistency}
\end{figure*}

\subsection{Comparison to results in the literature}

After having aggregated and fitted models for our galaxies, we examine how our models compare to other results in the literature. Part of the motivation for exploring the \textit{Galaxy Builder} method was that there exists no published large sample of galaxies with four-component photometric fits. This means we can only make comparisons for individual or subsets of model components (e.g. just disc and bulge) and by design \textit{Galaxy Builder} models will differ as we have attempted to fit bulge-disc-bar-spiral models to all our galaxies. The reader is therefore cautioned against treating literature models as any kind of ``ground truth'' since deviation from these simple models is part of the goal of this project. We provide these comparisons not to check how well our models work, but to provide data on how they compare with other well known, but much simpler photometric models.

\subsubsection{Comparison to Galaxy Zoo morphology}

The simplest comparison we can make to external results is to examine whether our models respect the existing morphological classifications present in the literature. We make use of Galaxy Zoo 2 (GZ2, \citealt{Willett2013:1308.3496v2}) results, including the redshift debiasing described in \citet{Hart2016:1607.01019v1} and spiral properties calculated in \citet{Hart2016:1607.01019v1}.

When comparing the probability of a volunteer's classification containing a bar component against a galaxy being classed as strongly-barred or as having no bar (as defined in \citealt{Masters2010:1003.0449v2}), we see reasonable agreement. Classifications of GZ2 strongly-barred galaxies ($p_\text{bar} > 0.5$) are more likely to contain a bar than GZ2 unbarred galaxies ($0.47 \pm 0.15$ vs. $0.29 \pm 0.11$). While there is some overlap in these probabilities, the Pearson correlation between GZ2's $p_\text{bar}$ and the bar likelihood in \textit{Galaxy Builder} is $0.56$, implying a significant correlation. We also note that GZ2 bar classifications exclude most weak bars \citep{2017MNRAS.469.3363K}.

We also compare the number of spiral arms aggregated by \textit{Galaxy Builder} with the responses to the GZ2 ``number of arms'' question (of which the possible responses were one, two, three, four, more than four or ``Can't tell''). We attempt to account for the spread in volunteer answers to this question by binning responses, rather than using the mean or modal response. The results of this comparison can be seen in Figure \ref{fig:n_spirals_comparison}. The area of each circle can be seen as the level of agreement between \textit{Galaxy Builder} aggregate models and GZ2 classifiers, it is defined as

\begin{equation}
  \label{eq:spiral_circle_area_size}
  A_{i, j} \propto \sum_{k}^{N_g}\frac{1}{M_k}\sum_{m}^{M_k}
  \begin{cases}
    1,&\ \mathrm{if}\ n_k = i\ \mathrm{and}\ C_{k, m} = j\\
    0,&\ \mathrm{otherwise}
  \end{cases},
\end{equation}

where $n_k$ is the number of aggregate arms for galaxy $k$ (out of $N_g$ galaxies), $C_{k, m}$ is the $m$-th answer for galaxy $k$ (out of $M_k$ answers).

The circle with the largest area for each possible GZ2 response is highlighted, and agrees with the number of spiral arms aggregated here for $m=1, 2, 3, 4$. No aggregate model contained more than four spiral arms, and when galaxies have an uncertain number of spiral arms (the ``Can't tell'' GZ2 response) we mostly do not aggregate any spiral arms.

It is not uncommon in \textit{Galaxy Builder} for one spiral arm to have been broken into two smaller segments. We also occasionally identify two distinct clusters that represent the same physical arm. These two reasons account for a majority of cases where GZ2 classifications suggest a galaxy has two spiral arms and we have clustered a larger number. Improved project user experience would be crucial in correcting these errors.

\begin{figure}
  \plotone{images__results/spiral-number-vs-gz2.pdf}
  \caption{Density plot of GZ2 vote counts for spiral arm number vs the number of spiral arms obtained through aggregation. The area of each circle can be seen as the level of agreement between \textit{Galaxy Builder} aggregate models and GZ2 classifiers, and is defined by Equation \ref{eq:spiral_circle_area_size}. The circle with the largest area for each possible GZ2 response is highlighted by shading. The 1:1 relationship suggests the clustering method is correctly recovering the behaviour of volunteers.}
  \label{fig:n_spirals_comparison}
\end{figure}


\subsubsection{Comparison to One-component fit - axis ratio}

We compare the axis ratios of the discs of \textit{Galaxy Builder} aggregate models (without fitting) to the axis ratio of a 2D S\'ersic fit to the $r$-band SDSS image of each galaxy (as provided in the NSA catalog, \citealt{2011AJ....142...31B}). For these untuned models there is an error of $\sim0.1$, consistent with our expected errors (derived in Section \ref{sec:error_estimation}).

We observe a clustering of outlying values around $b/a=0.5$. This is almost certainly due to the drawing tool ellipse having a default axis ratio of 0.5. Where this default is a ``good enough'' fit we hypothesise that volunteers are less likely to modify it, while if it needs to move a long way they find a more refined value. Overall we see that 36\% of all disc components drawn by volunteers were left at the default axis ratio. We recommend that future projects should carefully consider their interface design to minimize this bias (e.g. forcing volunteers to draw both the major and minor axis), however the fitting process we implement on the aggregate models successfully removes the bias, and the overall scatter does not change significantly.

As we account for light in spiral arms and bars, we expect that disc axis ratios fit by \textit{Galaxy Builder} should be more physical than those from models that do not account for how these non axisymmetries can bias measurements of ellipticity.

\begin{figure}
  \plotone{images__results/gzb-agg-nsa-comparison.pdf}
  \caption{Difference between the axis ratios of the aggregated disc component (before fitting) to the results of an $r$-band S\'ersic profile fit. Points  between one- and two-sigma are highlighted as orange squares, points outside $2\sigma$ are shown as red stars. While the overall relationship is good, the increase prevalence of points outside $2\sigma$ is a clear indication of bias caused by the \textit{Galaxy Builder} online user interface.}
  \label{fig:ax_ratio_comparison}
\end{figure}


\subsubsection{Comparison to Disc-Bulge models}

A strong motivation for performing multi-component modelling is the desire to measure the fraction of a galaxy's light being emitted by its central components (such as bulge fraction, defined as the ratio of bulge luminosity to total luminosity). \citet{Gao2017:1709.00746v1} demonstrate that modelling secondary central components is essential for recovering an accurate measure of bulge fraction. The difficulty of measuring bulge fraction is further compounded by the complex degeneracies present in even two-component fits, meaning that many gradient-descent based solvers often fail to find the globally optimum solution \citep{profit-paper}, especially when bulge S\'ersic index is a free parameter.

One of the largest catalogs of 2D multi-component fits is \citet{2011ApJS..196...11S}, which performed simultaneous, two-bandpass decompositions of 1,123,718 galaxies in the Legacy area of the SDSS DR7 using \textsc{Gim2D}. Three variations of models were fitted: a pure S\'ersic model, an Exponential disc and de-Vaucouleurs bulge model (hereafter exp+deV), and an Exponential disc and a S\'ersic bulge model (exp+S). Fitting was performed using the Metropolis algorithm, which is resilient to local minima and therefore suitable for the complex likelihood space of galaxy photometric modelling. \citet{2012MNRAS.421.2277L} similarly fitted two models to SDSS main-sample galaxies: an exponential disc and exponential bulge (exp+exp), and an exponential disc and de Vaucouleurs bulge. They used a Levenberg-Marquadt gradient descent algorithm, with initial parameters taken from previous SDSS analysis.

We compare our central component fraction (the flux of the bulge and bar relative to the total model flux) to bulge fraction from \citet{2011ApJS..196...11S} where their analysis indicated genuine bulge+disc systems ($P_{pS} \le 0.32$). We compare to \citet{2012MNRAS.421.2277L} bulge fractions only when their model selection criteria determined that model was the best-fit model. We see a strong correlation with significant scatter (Figure \ref{fig:bulge_fractions}). The relationship to exp+deV models appears to be less than 1:1, while the relationship to exp+exp models is greater than 1:1, highlighting the dependence of bulge fraction on S\'ersic index. Taking \textit{Galaxy Builder} results as ground truth implies that exp+deV puts too much light into the bulge, while exp+exp puts too little.

The amount of scatter (and lack of consistent 1:1 relationships) between bulge fractions between any two of the published two-component models is comparable to the scatter we see between any one of them and our more complex model. Bulge fractions for complex multi-component galaxies fit with any method should be used with caution.

\begin{figure*}
  \plotone{images__results/bulge_fraction_scatter_reduced.pdf}
  \caption{Scatter plots comparing the ratio of flux from central components (bulge and bar) to the total flux between fitted models from \textit{Galaxy Builder} and two-component models in the literature. Our models are broadly consistent with their results, but should be more accurate for complex galaxies, as we account for galaxy bars.}
  \label{fig:bulge_fractions}
\end{figure*}


\subsubsection{Comparison to Disc-Bulge-Bar models}

\citet{2018MNRAS.473.4731K} performed multi-component (up to three), multi-band decompositions of a selection of SDSS galaxies, 23 of which were also classified in \textit{Galaxy Builder} (with 16 in the repeated validation subset). Figure \ref{fig:sd_comp_comparison} compares the axis ratios and effective radii of bulges, discs and bars in \citet{2018MNRAS.473.4731K} to those present in the fitted models. We see good consistency in effective radii of all components in the majority of galaxies. There is more scatter in the fit axis ratios of components. In particular we observe many of the \textit{Galaxy Builder} bulges reaching the imposed lower boundary. Comparing the central component fraction between \textit{Galaxy Builder} models and those in \citet{2018MNRAS.473.4731K}, we see next to no scatter.

\begin{figure}
  \plotone{images__results/sd_comp_comparison_fitted.pdf}
  \caption{Comparison between \textit{Galaxy Builder} fitted models and the result of 3-component, multi\-wavelength fits performed by \citet{2018MNRAS.473.4731K}. Discs, Bulges and Bars are shown as blue circles, orange stars and green squares respectively. The left panel compares component effective radius, the right panel compares the component axis ratio. The components match well, with bulges showing the most scatter. Bulges in \textit{Galaxy Builder} fit models often get stuck at the lower allowed value, despite the physically motivated initial conditions.}
  \label{fig:sd_comp_comparison}
\end{figure}

\subsubsection{Comparison to Disc-Bulge-Bar-Spiral models}
To the best of our knowledge, no photometric models exist for the \textit{Galaxy Builder} sample which contain spiral arm structure. The closest comparable result is that produced by \citet{Gao2017:1709.00746v1}, however the galaxies they used are not in the Sloan footprint.

In order to provide a comparison for our novel method of spiral parameter (pitch angle and amplitude) extraction, we compare the result of our galaxy length-weighted pitch angles to the relationship obtained by \citet{Hart2016:1607.01019v1} between GZ2 classification and galaxy pitch angle. Their fit was obtained by using the Zooniverse project \textit{Spiral Spotter} to filter good vs bad spiral arm segments identified using an automated spiral arm detection and fitting tool, \textsc{SpArcFiRe} \citep{Davis2014:1402.1910v1}, whereas \textit{Galaxy Builder} asks volunteers to provide their own opinion on spiral arm number, location and tightness. \textit{Galaxy Builder} pitch angles are within the (large) uncertainties on the \citet{Hart2016:1607.01019v1} fit.

Many researches (\citealt{Davis2014:1402.1910v1}, \citealt{2019arXiv190804246D} to name a few) have noted that many galaxies show large inter-arm variations in pitch angle, suggesting that obtaining a single value of a galaxy's pitch angle is highly dependent on which arms have been identified. We plan to further explore this issue in future work.

\end{document}
