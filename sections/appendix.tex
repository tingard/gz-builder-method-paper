% !TEX root = ../main.tex
\documentclass[../main.tex]{subfiles}
\begin{document}

\section{Mathematical description of the poly-line separation measure}
\label{appendix:clustering_maths}

This appendix details the metric used in Section \ref{sec:aggregation_of_volunteer_models} to cluster poly\-lines used by volunteers to model spirals arms. It can be seen as a variant of the Fr√©chet distance.

First, define a poly-line containing $n$ 2D cartesian coordinates (vertices) as

\begin{equation}
A: \{i \in \mathbb{N};\;i<n\} \longrightarrow \mathbb{R}
^2\end{equation}

We also define a function, $t$, which calculates how far a point $\vec{p}$ is along the line between two other points ($\vec{v}$ and $\vec{w}$):

\begin{equation}
t(\vec{p},\,\vec{v},\,\vec{w}) \equiv \frac{(\vec{p} - \vec{v})\cdot(\vec{v} - \vec{w})}{|\vec{w} - \vec{v}|^2}.
\end{equation}

The minimum distance from $\vec{p}$ to the line segment between $\vec{v}$ and $\vec{w}$ is given by

\begin{equation}
d(\vec{p},\,\vec{v},\,\vec{w}) = \|\left(\vec{v} + \mathrm{min}(\mathrm{max}(t(\vec{p},\,\vec{v},\,\vec{w}),\, 0),\, 1)\;(\vec{w} - \vec{v})\right) - \vec{p}\|
\end{equation}

We then define a ``squared distance'' from the poly-line $A$ (containing $n$ vertices) to the poly-line $B$ (containing $m$ vertices):

\begin{equation}
D(A,\,B) \equiv \sum_{i = 0}^{n} \mathrm{min}\{j \in \mathbb{N}_0,\, j < m;\; d(A_i,\, B_j,\, B_{j+1})^2\}.
\end{equation}

The choice to square the distances and penalize large deviations from other lines was a data-driven choice to improve the results of clustering.

Finally, we define our separation measure between two drawn poly-lines as

\begin{equation}
distance(A,\,B) \equiv D(A,\,B) + D(B,\,A).
\end{equation}


\section{Default Values and Parameter Limits}
\begin{table*}
  \centering
  \begin{tabular}{l|l|r|r|r|r|r}
\hline
Component & Parameter &  Default &  Volunteer allowed &  Volunteer allowed & Tuning Maximum & Tuning Minimum \\
 &  &   &  Maximum &  Minimum & Bound & Bound \\
\hline
disk & axRatio &      0.5 &      inf &      0.0 & 0.01 & 100 \\
       & scale &      2.0 &     1.00 &      0.0 & 0 & inf \\
       & i0 &      1.0 &     0.20 &      0.0 & 0 & inf \\
bulge & axRatio &      0.5 &      inf &      0.0 & 0.01 & 100 \\
       & scale &      2.0 &     1.00 &      0.0 & 0 & inf \\
       & i0 &      2.0 &     0.50 &      0.0 & 0 & inf   \\
       & n &      5.0 &     1.00 &      0.5 & 0.1 & 10 \\
bar & roll &      0.0 &      inf &     -inf & 0.01 & 100 \\
       & scale &      2.0 &     1.00 &      0.0 & 0 & inf \\
       & i0 &      1.0 &     0.20 &      0.0 & 0 & inf   \\
       & n &      2.0 &     0.50 &      0.3 & 0.1 & 10 \\
       & c &      3.0 &     2.00 &      1.5 & 0.01 & 10 \\
spiral & i0 &      1.0 &     0.75 &      0.0 & 0 & inf   \\
       & spread &      2.0 &     1.00 &      0.0 & 0 & inf   \\
       & falloff &      2.0 &     1.00 &      0.0 & 0.01 & inf   \\
\hline
  \centering
  \end{tabular}
  \caption{The maximum, minimum and default values for model parameters. Note that some parameters were allowed to overflow when fitting, for instance an axis ratio greater 1 (signifying a swap of major and minor axis) was allowed, and corrected for once fitting reached completion. This helped avoid the optimizer encountering parameter bounds and failing to converge. Component roll was similarly unconstrained.}
  \label{table:bad_values}
\end{table*}
\end{document}
